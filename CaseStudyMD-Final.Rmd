---
title: "CaseStudy1"
author: "Jonathan Flores"
date: "February 12, 2018"
output: 
  md_document:
    variant: markdown_github
---

## Source Documents

``` {r echo=TRUE, results='asis'}

## Saved the csv documents on GitHub, the code below process information from GitHub instead of our local computers.

require(RCurl)

## Reading from beers csv. The csv is saved on GitHub

Beers <- data.frame(read.csv(text = getURL("https://raw.githubusercontent.com/jfzjonathan/casestudy1/master/Beers.csv"),header = TRUE,sep=","))

## Reading from breweries csv. The csv is saved on GitHub

Breweries <- data.frame(read.csv(text = getURL("https://raw.githubusercontent.com/jfzjonathan/casestudy1/master/Breweries.csv"),header = TRUE,sep=","))


```

## Making the raw data tidy data

```{r echo=TRUE, results='asis'}

## Renaming Beer columns

colnames(Beers) <- c("BeerName", "BeerID", "ABV", "IBU", "BreweryID","BeerStyle", "Ounces")


## Renaming Breweries columns

colnames(Breweries) <- c("BreweryID", "BreweryName", "BreweryCity", "BreweryState")


```

``` {r echo=TRUE, results='asis'}
## Displaying the first rows of Beer to make sure they transfer properly


library(knitr)
knitr::kable(head(Beers))


## Displaying the first rows of Breweries to make sure they transfer properly


knitr::kable(head(Breweries))

```

##1. How many breweries are present in each state?


``` {r echo=TRUE, results='asis'}

## Displaying table with States (two letter) and the number of Breweries per State

kable(data.frame(table(Breweries$BreweryState)),col.names=c("State","Number of Breweries"))


```


##2. Merge beer data with the breweries data. Print the first 6 observations and the last six observations to check the merged file.

``` {r echo=TRUE, results='asis'}
## Mergin dataframe Brewwries and Beers by "BreweryID" and assinging to object BeerBreweries

BeerBreweries <- merge(Beers, Breweries, by="BreweryID")

## Displaying table with first 6 and last 6 observertions of the merged file.

knitr::kable(rbind(head(BeerBreweries),tail(BeerBreweries)))

```



## 3. Report the number of NA's in each column.

``` {r echo=TRUE, results='asis'}

## Displaying table with columns and the number of NA's on each column

kable(sapply(data.frame(sapply(BeerBreweries, is.na)),sum),col.names="Number of NA's")

```


## 4. Compute the median alcohol content and international bitterness unit for each state. Plot a bar chart to compare.

``` {r echo=TRUE, results='asis'}
## Tidying data for ABV
## 1st, eliminate rows with NA's in ABV

ABVwoNA <- BeerBreweries[-which(is.na(BeerBreweries$ABV)),]

## Calculate median alcohol content by state and assign to object ABVbyState, create 

ABVbyState <- tapply(ABVwoNA$ABV, ABVwoNA$BreweryState, median)

## Displying bar char of median alcohol content by state

par(las=2)
barplot(ABVbyState, main="Median Alcohol Content by State", horiz=TRUE, xlab="Median Alcohol Content", ylab="State", cex.names=0.4)

```


## 5. Which state has the maximum alcoholic (ABV) beer? Which state has the most bitter (IBU) beer?

``` {r echo=TRUE, results='asis'}

## Display which state has the maximun ABV beer

cat(names(ABVbyState[which(ABVbyState==max(ABVbyState))]))


```

